<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="mystyle.css">
  <title>华东师范大学热点观察</title>
  <!--引入 JQuery, Echarts-->
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <script src="./javascripts/echarts-wordcloud/dist/echarts-wordcloud.js"></script>
</head>
<header>
</header>

<body>
<!--导航栏-->
<nav>
  <ul class="navbar">
    <li><a href="#" id="main">主页引导</a></li>
    <li><a href="#" id="contentQuery">内容查询</a></li>
    <li><a href="#" id="complexQuery">复合查询</a></li>
    <li><a href="#" id="hotAnalysis">热度分析</a></li>
    <li><a href="#" id="wordCloud">词云展示</a></li>
    <li><a href="#" id="comment">留言板块</a></li>
  </ul>
</nav>

<h1>
  华东师范大学热点观察
</h1>

<!--主页引导-->
<div id="mainDiv">
  <div id="mainText">
    <br>欢迎来到Ryan Watson的华东师范大学热点观察！
    <br>我们收集了华东师范大学“新闻热点”栏目近期的新闻，为您创造了一个方便的检索环境。
    <br>点击上方“内容查询”按钮，可以进行简单的内容查询。您可以选择查询的条件，也可以选择查询结果排序的方式。
    <br>点击上方“复合查询”按钮，可以进行多条件的复合查询。您可以选择两个条件进行查询。
    <br>点击上方“热度分析”按钮，可以进行折线图的生成。输入一个关键词后，该折线图可以为您描绘该关键词每一天出现的数量。
    <br>点击上方“词云展示”按钮，可以进行词云图的生成。您可以得到一张所有关键词的词云图。
    <br>点击上方“留言板块”按钮，您可以对该网站做出评价，我们会收到您给出的评价。
    <br>点击上方“主页引导”按钮，您可以回到此页面。
  </div>
  <img src="ame.webp" alt="Amelia Watson is reading a book." title="Watson正在积极为查询任务筹备" id="Ame">
  <div id="copyright">
    &copy; 2023 Ryan Watson. All rights reserved.
  </div>
</div>

<!--内容查询-->
<div id="contentQueryDiv">
  <!--表单-->
  <form id="content">
    <br>
    <label for="searchText">检索内容：</label>
    <!--搜索框-->
    <input type="text" name="title_text" id="searchText">
    <!--下拉菜单，允许选择查询条件-->
    <select id="searchType">
      <option value="title">新闻标题</option>
      <option value="content">新闻内容</option>
      <option value="keywords">新闻关键词</option>
    </select>
    <!--下拉菜单，允许选择排序方式-->
    <label for="sortType"></label><select id="sortType">
    <option value="date">按时间排序</option>
    <option value="title">按标题排序</option>
  </select>
    <input class="form-submit" type="button" value="查询" id="Text">
  </form>
  <!--表格-->
  <div class="container">
    <div class="cardLayout" style="margin: 10px 0">
      <table width="100%" id="record2"></table>
    </div>
  </div>
  <!--翻页按钮-->
  <div class="button-container">
    <button id="prevPage" class="button">上一页</button>
    <button id="nextPage" class="button">下一页</button>
  </div>
  <!--用于显示页码信息-->
  <div id="paginationInfo"></div>
  <!--用于进行页码跳转-->
  <div id="pageJump">
    <form id="pageTrans">
      <label>跳转至第</label>
      <input type="text" name="page_text" id="searchPage">
      <label>页</label>
      <input class="form-submit" type="button" value="跳转" id="Page">
    </form>
  </div>
</div>

<!--复合查询-->
<div id="complexQueryDiv" style="display: none;">
  <!--表单-->
  <form id="complexQueryForm">
    <br>
    <label for="searchText1">查询条件1：</label>
    <!--搜索框-->
    <input type="text" name="searchText1" id="searchText1">
    <!--下拉菜单，允许选择查询条件1-->
    <select id="searchType1">
      <option value="title">新闻标题</option>
      <option value="content">新闻内容</option>
      <option value="keywords">新闻关键词</option>
    </select>
    <br>
    <label for="searchText2">查询条件2：</label>
    <input type="text" name="searchText2" id="searchText2">
    <!--下拉菜单，允许选择查询条件2-->
    <select id="searchType2">
      <option value="title">新闻标题</option>
      <option value="content">新闻内容</option>
      <option value="keywords">新闻关键词</option>
    </select>
    <br>
    <input class="form-submit" type="button" value="查询" id="Complex">
  </form>
  <!--表格-->
  <div class="container">
    <div class="cardLayout" style="margin: 10px 0px">
      <table width="100%" id="record1"></table>
    </div>
  </div>
  <!--翻页按钮-->
  <div class="button-container">
    <button id="prevPage2" class="button">上一页</button>
    <button id="nextPage2" class="button">下一页</button>
  </div>
  <!--用于显示页码信息-->
  <div id="paginationInfo2"></div>
  <!--用于进行页码跳转-->
  <div id="pageJump2">
    <form id="pageTrans2">
      <label>跳转至第</label>
      <input type="text" name="page_text" id="searchPage2">
      <label>页</label>
      <input class="form-submit" type="button" value="跳转" id="Page2">
    </form>
  </div>
</div>

<!--热度分析-->
<div id="hotAnalysisDiv">
  <!--表单-->
  <form>
    <br><label>检索内容：</label><input type="text" name="title_text" id="searchHot">
    <input class="form-submit" type="button" value="热度" id="Hot">
  </form>
  <!--便于限定 chartContainer 的位置，进行美观处理-->
  <div id="chartContainerWrapper">
    <!--图表区域-->
    <div id="chartContainer">
    </div>
    <div id="infoMessageContainer">
      <label id="infoMessage">*7月9日的新闻来源选择较少，故总新闻数较少。</label>
    </div>
  </div>
</div>

<!--词云展示-->
<div id="wordCloudDiv">
  <!--便于限定 wordCloudDrawing 的位置，进行美观处理-->
  <div id="wordCloudWrapper">
    <div id="wordCloudDrawing"></div>
  </div>
</div>

<!--留言板块-->
<div id="commentDiv">
  <label id="commentText">请留下您宝贵的意见！</label>
  <div>
    <textarea id="messageInput" placeholder="请输入留言……"></textarea>
    <button id="submitButton">提交</button>
  </div>
</div>

<!--版权标记-->
<div class="footer">
  &copy; 2023 Ryan Watson. All rights reserved.
</div>

<!--Javascript 后端-->
<script>
  $(document).ready(function() {
    var currentPage = 1;        // 内容查询页面使用的当前页码
    var currentPage2 = 1;       // 复合查询页面使用的当前页码
    var itemsPerPage = 10;      // 每页显示的条目数
    var data = [];              // 存储内容查询时的所有数据
    var data_2 = []             // 存储复合查询时的所有数据
    var totalPages;             // 内容查询页面页数的最大值
    var totalPages2;            // 复合查询页面页数的最大值

    // 提前准备词云图数据
    var keywordsArray_original = [];        // 原始的所有关键词数据，即使重复也存储
    // 存储真正使用到的数据，其中 image 是词云背景图片的 base64 编码
    var dataArray = {useValue:[], image:"data:image/png;base64,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"};
    var allData = [];                       // 所有数据
    var keywordsArray = [];                 // 互斥的关键词数据
    var url = '/process_get?type=title&query=&sort=date';   // 发起检索使用的url
    $.get(url, function(response) {
      if (dataArray["useValue"].length === 0) {
        allData = response;                 // 将获取的数据存储到 allData 中
        var dataNumber = allData.length;
        for (var num = 0; num < dataNumber; num++) {
          /* 不同的新闻有不同的关键词标注格式
          *  分别对使用逗号、分号、空格的分割方式进行处理 */
          if (allData[num]['keywords'].indexOf(',') !== -1)
            allData[num]['keywords'] = allData[num]['keywords'].split(",");
          else if (allData[num]['keywords'].indexOf(';') !== -1)
            allData[num]['keywords'] = allData[num]['keywords'].split(";");
          else allData[num]['keywords'] = allData[num]['keywords'].split(" ");
          // 将关键词加入 keywordsArray_original 数组，这里将空关键词删去
          for (var array_num = 0; array_num < allData[num]['keywords'].length; array_num++) {
            if (allData[num]['keywords'][array_num] !== "")
              keywordsArray_original.push(allData[num]['keywords'][array_num]);
          }
        }
        // 筛选互异的关键词加入 keywordsArray 数组
        for (num = 0; num < keywordsArray_original.length; num++) {
          if (keywordsArray.indexOf(keywordsArray_original[num]) === -1)
            keywordsArray.push(keywordsArray_original[num]);
        }
        // 生成一个记录每个关键词出现频率的数组，这里将其中的每个元素都置为0
        var frequencyArray = new Array(keywordsArray.length).fill(0);
        // 记录每个关键词出现的频率
        for (num = 0; num < keywordsArray_original.length; num++) {
          var cnt = keywordsArray.indexOf(keywordsArray_original[num]);
          frequencyArray[cnt]++;
        }
        /* 对每个关键词生成一个形如 {name:..., value:...} 的对象
        *  其中，name 是关键词，value 是其出现频率 */
        for (num = 0; num < keywordsArray.length; num++) {
          var name_value = {name: keywordsArray[num], value: frequencyArray[num]};
          dataArray["useValue"].push(name_value);
        }
        // 让对象基于关键词的出现频率从高到低排序
        dataArray["useValue"] = dataArray["useValue"].sort((a, b) => b.value - a.value).slice(0, 150);
      }
    });

    // 显示且仅显示主页引导相关内容
    $("#main").click(function() {
      $("#contentQueryDiv").hide();
      $("#complexQueryDiv").hide();
      $("#hotAnalysisDiv").hide();
      $("#wordCloudDiv").hide();
      $("#mainDiv").show();
      $("#commentDiv").hide();
      $(".footer").hide();
    });

    // 显示且仅显示内容查询相关内容
    $("#contentQuery").click(function() {
      $("#contentQueryDiv").show();
      $("#complexQueryDiv").hide();
      $("#hotAnalysisDiv").hide();
      $("#wordCloudDiv").hide();
      $("#mainDiv").hide();
      $("#commentDiv").hide();
      $(".footer").show();
    });

    // 显示且仅显示复合查询相关内容
    $("#complexQuery").click(function() {
      $("#contentQueryDiv").hide();
      $("#hotAnalysisDiv").hide();
      $("#wordCloudDiv").hide();
      $("#complexQueryDiv").show();
      $("#mainDiv").hide();
      $("#commentDiv").hide();
      $(".footer").show();
    });

    // 显示且仅显示热度分析相关内容
    $("#hotAnalysis").click(function() {
      $("#contentQueryDiv").hide();
      $("#hotAnalysisDiv").show();
      $("#wordCloudDiv").hide();
      $("#complexQueryDiv").hide();
      $("#mainDiv").hide();
      $("#commentDiv").hide();
      $(".footer").show();
    });

    // 显示且仅显示留言板块相关内容
    $("#comment").click(function() {
      $("#commentDiv").show();
      $("#contentQueryDiv").hide();
      $("#hotAnalysisDiv").hide();
      $("#wordCloudDiv").hide();
      $("#complexQueryDiv").hide();
      $("#mainDiv").hide();
      $(".footer").show();
    });

    // 显示且仅显示词云展示相关内容，并且直接绘制词云
    $("#wordCloud").click(function() {
      $("#contentQueryDiv").hide();
      $("#complexQueryDiv").hide();
      $("#hotAnalysisDiv").hide();
      $("#wordCloudDiv").show();
      $("#mainDiv").hide();
      $("#commentDiv").hide();
      $(".footer").show();
      // 绘制云图
      var myChart = echarts.init(document.getElementById('wordCloudDrawing'));
      var maskImage = new Image();
      maskImage.src = dataArray.image;
      // 指定图表的配置项和数据
      option = {
        tooltip: {
          show: true
        },
        series: [
          {
            type: 'wordCloud',          // 词云图
            gridSize: 1,                // 词的间距
            // shape: 'diamond',           // 词云形状，可选diamond，pentagon，circle，triangle，star等形状
            rotationRange: [-45, 0, 45, 90],
            maskImage: maskImage,       // 词云背景形状
            sizeRange: [18, 40],        // 词云大小范围
            width: 750,                 // 词云显示宽度
            height: 590,                // 词云显示高度
            textStyle: {
              color: function () {
                // 词云的颜色随机
                return (
                        'rgb(' +
                        [
                          Math.round(Math.random() * 160),
                          Math.round(Math.random() * 160),
                          Math.round(Math.random() * 160)
                        ].join(',') +
                        ')'
                );
              },
              emphasis: {
                shadowBlur: 10,         // 阴影的模糊等级
                shadowColor: '#333'     // 鼠标悬停在词云上的阴影颜色
              }
            },
            data: dataArray["useValue"]
          }
        ]
      };
      // 使用刚指定的配置项和数据显示图表，并且确保每一次点击都可以生成词云图
      setTimeout(function() {
        myChart.setOption(option, true);
      }, 0);
    });

    // 点击内容查询页面的“查询”按钮，进行搜索与显示
    $("input:button#Text").click(function() {
      var searchType = $("#searchType").val();
      var searchText = $("input#searchText").val();
      var sortType = $("#sortType").val();
      var url = '/process_get?type=' + searchType + '&query=' + searchText + '&sort=' + sortType;

      $.get(url, function(response) {
        data = response;            // 将获取的数据存储到 data 变量中
        totalPages = Math.ceil(data.length / itemsPerPage);
        currentPage = 1;            // 重置当前页码为第一页
        paginateData();             // 分页处理数据
        updatePaginationInfo();     // 更新页码信息
      });
    });

    // 绘制热度分析图表
    function Drawer() {
      var chart_data = [];        // 存储作热度图的所有数据
      var real_dates = [];        // 存储热度图的横坐标，即日期
      // 创建和配置 Echart 折线图
      // 如果新闻内容里有该词，就获取该新闻
      $.get('/process_get?type=content&query=' + $("input#searchHot").val(), function(response) {
        chart_data = response;  // 将获取的数据存储到 chart_data 中
        var chartContainer = document.getElementById('chartContainer');
        var myChart = echarts.init(chartContainer);
        var dates = chart_data.map(item => item.publish_date);  // 获取所有的时间，置于 dates 数组中
        // 切片，取得 YYYY-MM-DD 格式的时间
        for (var j = 0; j < dates.length; j++)
        {
          dates[j] = dates[j].slice(0,10);
        }
        // 筛选互异的时间信息，加入 real_dates 数组
        for (j = 0; j < dates.length; j++)
        {
          if (real_dates.indexOf(dates[j]) === -1)
          {
            real_dates.push(dates[j]);
          }
        }
        function compareDates(date1, date2) {
          var dateObj1 = new Date(date1);
          var dateObj2 = new Date(date2);
          return dateObj1 - dateObj2;
        }
        real_dates.sort(compareDates);
        // 生成一个记录每天新闻数量的数组，这里将其中的每个元素都置为0
        var values = new Array(real_dates.length).fill(0);
        for (var k = 0; k < real_dates.length; k++)
        {
          for (j = 0; j < dates.length; j++)
          {
            if (dates[j] === real_dates[k])
              values[k]++;
          }
        }
        /* 假如搜索框为空，则显示所有新闻数量的热度分析图
        *  假如搜索框不为空，则显示搜索框内容的热度分析图 */
        var word;
        if ($("input#searchHot").val() === "")
        {
          word = '新闻数量';
        }
        else
        {
          word = '"' + $("input#searchHot").val() + '"一词';
        }
        var option = {
          title: {
            left: 'center',
            text: word + '的热度折线图'
          },
          xAxis: {
            type: 'category',
            data: real_dates,
            name: "Date",
            nameLocation: 'middle',
            nameTextStyle:{
              padding:10
            }
          },
          yAxis: {
            type: 'value',
            name: "Number",
            nameLocation: 'middle',
            nameTextStyle: {
              padding:15
            }
          },
          tooltip: {
            trigger: 'axis',                                      // 触发类型为坐标轴轴线触发
            formatter: function(params) {                         // 格式化tooltip的内容
              var dataIndex = params[0].dataIndex;                // 获取悬停点的数据索引
              var dataOfIndex = real_dates[dataIndex];            // 根据索引获取对应的数据值
              var value = values[dataIndex];                      // 根据索引获取对应的数据值
              return '日期：' + dataOfIndex + ", 数量：" + value;   // 返回自定义格式化后的内容
            }
          },
          series: [
            {
              data: values,
              type: 'line',
              symbol: 'circle',
              symbolSize: 5,
              lineStyle: {
                color: '#5470C6',
                width: 3,
              },
              itemStyle: {
                borderWidth: 3,
                borderColor: '#EE6666',
                color: '#EE6666'
              }
            }
          ]
        };

        // 渲染折线图
        myChart.setOption(option);
      });
    }

    // 点击热度分析页面的“热度”按钮，进行热度分析题的绘制
    $("input:button#Hot").click(function() {
      Drawer();
    });

    // 点击热度复合查询的“查询”按钮，进行复合搜索和显示
    $("#Complex").click(function() {
      var searchText1 = $("#searchText1").val();
      var searchType1 = $("#searchType1").val();
      var searchText2 = $("#searchText2").val();
      var searchType2 = $("#searchType2").val();

      var url = '/process_complex_query?type=complex&searchText1=' + searchText1 + '&searchType1=' + searchType1 + '&searchText2=' + searchText2 + '&searchType2=' + searchType2;

      $.get(url, function(response) {
        data_2 = response;          // 将获取的数据存储到 data_2 中
        totalPages2 = Math.ceil(data_2.length / itemsPerPage);
        currentPage2 = 1;           // 重置当前页码为第一页
        paginateData2();            // 分页处理数据
        updatePaginationInfo2();    // 更新页码信息
      });
    });

    // 在内容查询页面的搜索框按下回车，也可以进行搜索与显示
    $("#searchText").keypress(function(event) {
      if (event.which === 13) {           // 回车键的键码是13
        event.preventDefault();           // 阻止回车键默认提交表单的行为
        var searchType = $("#searchType").val();
        var searchText = $("input#searchText").val();
        var sortType = $("#sortType").val();
        var url = '/process_get?type=' + searchType + '&query=' + searchText + '&sort=' + sortType;

        $.get(url, function (response) {
          data = response;            // 将获取的数据存储到 data 变量中
          totalPages = Math.ceil(data.length / itemsPerPage);
          currentPage = 1;            // 重置当前页码为第一页
          paginateData();             // 分页处理数据
          updatePaginationInfo();     // 更新页码信息
        });
      }
    });

    // 在复合查询页面的搜索框按下回车，也可以进行搜索与显示
    $("#searchText1").keypress(function(event) {
      if (event.which === 13) {           // 回车键的键码是13
        console.log(1);
        event.preventDefault();           // 阻止回车键默认提交表单的行为
        var searchText1 = $("#searchText1").val();
        var searchType1 = $("#searchType1").val();
        var searchText2 = $("#searchText2").val();
        var searchType2 = $("#searchType2").val();

        var url = '/process_complex_query?type=complex&searchText1=' + searchText1 + '&searchType1=' + searchType1 + '&searchText2=' + searchText2 + '&searchType2=' + searchType2;

        $.get(url, function(response) {
          data_2 = response;          // 将获取的数据存储到 data_2 中
          totalPages2 = Math.ceil(data_2.length / itemsPerPage);
          currentPage2 = 1;           // 重置当前页码为第一页
          paginateData2();            // 分页处理数据
          updatePaginationInfo2();    // 更新页码信息
        });
      }
    });

    $("#searchText2").keypress(function(event) {
      if (event.which === 13) {           // 回车键的键码是13
        event.preventDefault();           // 阻止回车键默认提交表单的行为
        var searchText1 = $("#searchText1").val();
        var searchType1 = $("#searchType1").val();
        var searchText2 = $("#searchText2").val();
        var searchType2 = $("#searchType2").val();

        var url = '/process_complex_query?type=complex&searchText1=' + searchText1 + '&searchType1=' + searchType1 + '&searchText2=' + searchText2 + '&searchType2=' + searchType2;

        $.get(url, function(response) {
          data_2 = response;          // 将获取的数据存储到 data_2 中
          totalPages2 = Math.ceil(data_2.length / itemsPerPage);
          currentPage2 = 1;           // 重置当前页码为第一页
          paginateData2();            // 分页处理数据
          updatePaginationInfo2();    // 更新页码信息
        });
      }
    });

    // 在热度分析页面的搜索框按下回车，也可以进行热度分析图的绘制
    $("#searchHot").keypress(function(event) {
      if (event.which === 13) {           // 回车键的键码是13
        event.preventDefault();           // 阻止回车键默认提交表单的行为
        Drawer();
      }
    });

    // 在内容查询页面的页面跳转的搜索框按下回车，也可以进行页面跳转
    $("#searchPage").keypress(function(event) {
      if (event.which === 13) {           // 回车键的键码是13
        event.preventDefault();           // 阻止回车键默认提交表单的行为
        var page = parseInt($("input#searchPage").val());
        if (page <= totalPages && page > 0) {
          currentPage = page;
          paginateData();
          updatePaginationInfo();
        }
      }
    });

    // 在复合查询页面的页面跳转的搜索框按下回车，也可以进行页面跳转
    $("#searchPage2").keypress(function(event) {
      if (event.which === 13) {           // 回车键的键码是13
        event.preventDefault();           // 阻止回车键默认提交表单的行为
        var page2 = parseInt($("input#searchPage2").val());
        if (page2 <= totalPages2 && page2 > 0) {
          currentPage2 = page2;
          paginateData2();
          updatePaginationInfo2();
        }
      }
    });

    // 内容查询页面上一页按钮点击事件
    $("#prevPage").click(function() {
      if (currentPage > 1) {
        currentPage--;
        paginateData();
        updatePaginationInfo();
      }
    });

    // 内容查询页面下一页按钮点击事件
    $("#nextPage").click(function() {
      if (currentPage < totalPages) {
        currentPage++;
        paginateData();
        updatePaginationInfo();
      }
    });

    // 复合查询页面上一页按钮点击事件
    $("#prevPage2").click(function() {
      if (currentPage2 > 1) {
        currentPage2--;
        paginateData2();
        updatePaginationInfo2();
      }
    });

    // 复合查询页面下一页按钮点击事件
    $("#nextPage2").click(function() {
      if (currentPage2 < totalPages2) {
        currentPage2++;
        paginateData2();
        updatePaginationInfo2();
      }
    });

    // 内容查询页面的跳转按钮点击事件
    $("input:button#Page").click(function() {
      var page = parseInt($("input#searchPage").val());
      if (page <= totalPages && page > 0) {
        currentPage = page;
        paginateData();
        updatePaginationInfo();
      }
    });

    // 复合查询页面的跳转按钮点击事件
    $("input:button#Page2").click(function() {
      var page = parseInt($("input#searchPage2").val());
      if (page <= totalPages2 && page > 0) {
        currentPage2 = page;
        paginateData2();
        updatePaginationInfo2();
      }
    });

    // 内容查询页面的表格处理
    function paginateData() {
      $("#record2").empty();
      $("#record2").append('<tr class="cardLayout"><td>新闻标题</td><td>新闻来源</td>' +
              '<td>源地址</td><td>新闻日期</td></tr>');

      var startIndex = (currentPage - 1) * itemsPerPage;
      var endIndex = startIndex + itemsPerPage;
      var paginatedData = data.slice(startIndex, endIndex);

      for (let list of paginatedData) {
        let table = '<tr class="cardLayout"><td>';
        Object.values(list).forEach((element, index) => {
          if (index === 3) {
            element = element.slice(0,10);
            table += element;
            table += '</td>';
          }
          else if (index === 2) {
            table += '<a href="' + element + '">查看详情</a>';
            table += '</td><td>';
          }
          else if (index < 4) {
            table += element;
            table += '</td><td>';
          }
        });
        $("#record2").append(table + '</tr>');
      }
    }

    // 内容查询页面的页码显示
    function updatePaginationInfo() {
      var paginationInfo = "第" + currentPage + "页 / 共" + totalPages + "页";
      $("#paginationInfo").text(paginationInfo);
    }

    // 复合查询页面的表格处理
    function paginateData2() {
      $("#record1").empty();
      $("#record1").append('<tr class="cardLayout"><td>新闻标题</td><td>新闻来源</td>' +
              '<td>源地址</td><td>新闻日期</td></tr>');

      var startIndex2 = (currentPage2 - 1) * itemsPerPage;
      var endIndex2 = startIndex2 + itemsPerPage;
      var paginatedData2 = data_2.slice(startIndex2, endIndex2);

      for (let list of paginatedData2) {
        let table = '<tr class="cardLayout"><td>';
        Object.values(list).forEach((element, index) => {
          if (index === 3) {
            element = element.slice(0,10);
            table += element;
            table += '</td>';
          }
          else if (index === 2) {
            table += '<a href="' + element + '">查看详情</a>';
            table += '</td><td>';
          }
          else if (index < 4) {
            table += element;
            table += '</td><td>';
          }
        });
        $("#record1").append(table + '</tr>');
      }
    }

    // 复合查询页面的页码显示
    function updatePaginationInfo2() {
      var paginationInfo2 = "第" + currentPage2 + "页 / 共" + totalPages2 + "页";
      $("#paginationInfo2").text(paginationInfo2);
    }

    // 留言板块的 POST 请求
    var messageContent = "";
    var submitButton = document.getElementById('submitButton');
    submitButton.addEventListener('click', function() {
      var messageInput = document.getElementById('messageInput');
      messageContent = messageInput.value;
      fetch('/save-data', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({transData: messageContent})
      })
              .then(response => response.json())
              .then(transData => {
                alert(transData.message);
              });
    });
  });
</script>
</body>
</html>